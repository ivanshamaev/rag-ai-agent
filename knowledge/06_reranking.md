# Переранжирование (Reranking)

Reranking — этап, на котором набор candidate-документов, найденных retriever'ом, пересчитывается более точной моделью.

## Зачем нужен reranking

- Retriever ориентирован на recall и скорость; reranker повышает precision и порядок кандидатов.

## Типы reranker-моделей

- **Cross-encoder**: объединяет query и документ и пропускает через модель (дорого по latency, высокое качество).
- **Bi-encoder + MLP**: быстрое сравнение эмбеддингов с дополнительным ранжирующим слоем.

## Тренировка rerankers

- Используют пары (query, positive, negatives) и loss типа contrastive или margin-based.

## Практики

- Использовать reranker для top-N retrieved, чтобы держать latency в пределах.
- Каскадирование: быстрый dense/sparse → reranker → generator.

## Пояснение для новичка: зачем это и как выглядит

- **Рерэнкинг** нужен потому, что первичный поиск (retriever) может вернуть много кандидатов, среди которых не все релевантны. Reranker — как судья, который внимательно читает самые релевантные и ставит истинно лучшие выше.
- **Cross-encoder**: объединяет вопрос и документ и пропускает через модель — это медленнее, но точнее.
- **Bi-encoder**: быстрый способ получить эмбеддинги для сравнения, но для финального ранжирования часто уступает cross-encoder.

Пояснение: представьте, что вы ищете рецепты. Retriever находит 100 потенциальных рецептов, reranker читает 10 лучших и выбирает 2 самых подходящих по деталям (ингредиенты, шаги).
